<div class="navbar" *ngIf="isOpen$ | async">
    <app-drag-column
        (onDrag)="onDrag($event)"
        [maxWidth]="dragLimits.max"
        [minWidth]="dragLimits.min"
    >
        <div class="navbar-inner">
            <mat-nav-list class="subjects" *ngIf="subjectState">
                <mat-list-item
                    class="subject"
                    #menuTrigger="matMenuTrigger"
                    [matMenuTriggerFor]="menu"
                >
                    <mat-icon class="subject-icon" color="accent">add_circle</mat-icon>
                    <div class="subject-info">
                        <span class="subject-title">New Subject</span>
                    </div>
                </mat-list-item>

                <mat-menu #menu="matMenu" xPosition="after">
                    <app-navbar-new-subject
                        [menu]="menuTrigger"
                        (keydown)="$event.stopPropagation()"
                        (click)="$event.stopPropagation()"
                        (onSubmit)="createSubject($event)">
                    </app-navbar-new-subject>
                </mat-menu>

                <mat-divider></mat-divider>

                <mat-list-item class="subject" (click)="checkSubject(null)" [class.checked]="checkedSubject === null">
                    <mat-icon class="subject-icon" color="primary">folder_open</mat-icon>
                    <div class="subject-info">
                        <span class="subject-title">All Subjects</span>
                    </div>
                </mat-list-item>

                <ng-container *ngFor="let subject of subjectState.subjects">
                    <mat-list-item class="subject" (click)="checkSubject(subject)" [class.checked]="checkedSubject?.id === subject.id">
                        <mat-icon class="subject-icon" color="primary">folder_open</mat-icon>
                        <div class="subject-info">
                            <span class="subject-info__title">{{subject.title}}</span>
                            <span class="subject-info__description">{{subject.description}}</span>
                        </div>
                        <button mat-icon-button class="subject-menu-trigger" (click)="$event.stopPropagation()"
                                [matMenuTriggerFor]="subjectMenu">
                            <mat-icon>more_vert</mat-icon>
                        </button>

                        <mat-menu #subjectMenu="matMenu" xPosition="after" class="subject-menu">
                            <button mat-button class="subject-menu-btn" (click)="deleteSubject(subject)">
                                <span class="subject-menu-btn__inner">
                                    <mat-icon class="subject-menu-btn__icon" color="accent">delete</mat-icon>
                                    <span class="subject-menu-btn__text">Delete</span>
                                </span>
                            </button>
                        </mat-menu>
                    </mat-list-item>
                </ng-container>

            </mat-nav-list>
        </div>
    </app-drag-column>
</div>


